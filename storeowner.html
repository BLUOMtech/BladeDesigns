<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Blade Designs â€“ Owner</title>
<style>
body{font-family:sans-serif;background:#f2f2f2;margin:0;padding:20px}
.box{background:#fff;padding:20px;border-radius:10px;max-width:400px;margin:auto;margin-top:60px;box-shadow:0 4px 10px rgba(0,0,0,.1)}
input{width:100%;padding:10px;margin:10px 0;border-radius:8px;border:1px solid #ccc}
button{padding:10px;width:100%;border:none;border-radius:8px;background:#222;color:#fff;cursor:pointer;margin-top:5px}
.hidden{display:none}
.card{background:#fff;padding:10px;border-radius:10px;margin:10px 0}
</style>
</head>
<body>

<div id="loginBox" class="box">
  <h2>Owner Login</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
</div>

<div id="ownerPanel" class="hidden">
  <h2>Owner Panel</h2>
  <button onclick="logout()">Logout</button>

  <h3>Change Login Credentials</h3>
  <input id="newEmail" placeholder="New Email">
  <input id="newPass" type="password" placeholder="New Password">
  <button onclick="changeCredentials()">Change Login</button>

  <h3>Add Product</h3>
  <input id="title" placeholder="Title">
  <input id="price" type="number" placeholder="Price">
  <select id="type">
    <option value="physical">Physical</option>
    <option value="digital">Digital</option>
  </select>
  <input id="download" placeholder="Download path (digital)">
  <input id="image" type="file">
  <button onclick="addProduct()">Add Product</button>

  <h3>Orders</h3>
  <div id="orders"></div>
</div>

<script>
// ----- Simple Hasher -----
const BPhashIt = {
  hashit: function(str){
    let hash=0;
    for(let i=0;i<str.length;i++){
      hash=((hash<<5)-hash)+str.charCodeAt(i);
      hash|=0;
    }
    return hash.toString();
  }
};

// ----- Default credentials setup -----
if(!localStorage.getItem("ownerEmail")){
  localStorage.setItem("ownerEmail", BPhashIt.hashit("bladepeisker82@gmail.com"));
  localStorage.setItem("ownerPass", BPhashIt.hashit("blade123"));
}

// ----- Login / Logout -----
function login(){
  const eHash = BPhashIt.hashit(email.value);
  const pHash = BPhashIt.hashit(password.value);
  if(eHash === localStorage.getItem("ownerEmail") && pHash === localStorage.getItem("ownerPass")){
    document.getElementById("loginBox").classList.add("hidden");
    document.getElementById("ownerPanel").classList.remove("hidden");
    renderOrders();
    alert("Login successful!");
  } else alert("Incorrect login");
}

function logout(){
  document.getElementById("ownerPanel").classList.add("hidden");
  document.getElementById("loginBox").classList.remove("hidden");
  email.value=""; password.value="";
}

// ----- Change login -----
function changeCredentials(){
  if(newEmail.value && newPass.value){
    localStorage.setItem("ownerEmail", BPhashIt.hashit(newEmail.value));
    localStorage.setItem("ownerPass", BPhashIt.hashit(newPass.value));
    newEmail.value=""; newPass.value="";
    alert("Credentials updated! Please logout and login again.");
  } else alert("Enter both email and password");
}

// ----- Products -----
function getProducts(){return JSON.parse(localStorage.getItem("products")||"[]");}
function saveProducts(p){localStorage.setItem("products",JSON.stringify(p));}

function addProduct(){
  const r=new FileReader();
  r.onload=()=>{
    let p=getProducts();
    p.push({
      id:Date.now(),
      title:title.value,
      price:Number(price.value),
      type:type.value,
      image:r.result,
      download:download.value
    });
    saveProducts(p);
    alert("Product added!");
  };
  r.readAsDataURL(image.files[0]);
}

// ----- Orders -----
function renderOrders(){
  const orders=JSON.parse(localStorage.getItem("orders")||"[]");
  let html="";
  orders.forEach((o,i)=>{
    html+=`
    <div class="card">
      <b>${o.ref}</b><br>
      Paid: ${o.paid}<br>
      <button onclick="markPaid(${i})">Mark Paid</button>
    </div>`;
  });
  document.getElementById("orders").innerHTML=html;
}

function markPaid(i){
  let orders=JSON.parse(localStorage.getItem("orders")||"[]");
  orders[i].paid=true;
  localStorage.setItem("orders",JSON.stringify(orders));
  renderOrders();
}
</script>
</body>
</html>
